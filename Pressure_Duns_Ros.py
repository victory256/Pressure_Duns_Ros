"""
Расчет падения давления в скважине по методу Данса и Роса
"""
import math

# массив точек графика L_1 рисунка 4.6
L_1_mass = [
    [9.84255, 22.6121, 23.1498, 23.3065, 23.6815, 24.2038, 24.7374, 25.3043, 25.8624, 26.3882, 26.9473, 27.4948,
     28.0533, 28.5988, 29.1549, 29.7219, 30.1977, 30.6294, 31.0936, 31.5912, 32.0426, 32.4456, 32.826, 33.1549,
     33.4871, 33.8797, 34.2481, 34.6203, 35.0262, 35.4368, 35.7919, 36.1202, 36.4515, 36.8788, 37.3741, 37.8442,
     38.1915, 38.5741, 39.0265, 39.4843, 39.9138, 40.3819, 40.8553, 41.3345, 41.8542, 42.3449, 42.7334, 43.1258,
     43.6318, 44.1806, 44.6985, 45.1844, 45.7141, 46.1721, 46.635, 47.1421, 47.6145, 48.132, 48.7374, 49.3088,
     49.7608, 50.217, 50.763, 51.4447, 52.0916, 52.6136, 53.1407, 53.7186, 54.3483, 55.0317, 55.8179, 56.6151,
     57.3267, 58.0472, 58.8779, 59.5739, 60.0236, 60.9331, 62.3286, 63.2757, 64.2372, 65.2133, 66.2043, 67.7204,
     69.3315, 69.7988, 71.3986, 73.5911, 77.0068, 78.7722, 80, 100, 200, 300, 400, 500, 600, 700, 800, 900,
     1000],
    [2, 2, 1.995, 1.99, 1.98521, 1.98124, 1.97597, 1.972, 1.96803, 1.96277, 1.9575, 1.95029, 1.94244, 1.93329,
     1.92415, 1.915, 1.90392, 1.89155, 1.87983, 1.8681, 1.85444, 1.84013, 1.82518, 1.80958, 1.79399, 1.77904,
     1.76409, 1.74849, 1.73354, 1.71859, 1.703, 1.68741, 1.67182, 1.65686, 1.64255, 1.62825, 1.61331, 1.59771,
     1.58341, 1.5691, 1.5548, 1.5405, 1.52555, 1.51125, 1.49629, 1.48134, 1.4664, 1.4521, 1.43845, 1.42414,
     1.40919, 1.39359, 1.37864, 1.36305, 1.3481, 1.33315, 1.31756, 1.30196, 1.28766, 1.2727, 1.25647, 1.24023,
     1.22528, 1.21097, 1.19601, 1.18042, 1.16483, 1.14988, 1.13493, 1.11997, 1.10631, 1.09199, 1.07639, 1.06079,
     1.05036, 1.04902, 1.04316, 1.03144, 1.02552, 1.01963, 1.01374, 1.00785, 1.00196, 1, 1, 1, 1, 1, 1, 1, 1, 1,
     1, 1, 1, 1, 1, 1, 1, 1, 1]]
# массив точек графика L_2 рисунка 4.6
L_2_mass = [
    [15.8353, 16.132, 16.4341, 16.7977, 17.1549, 17.5053, 17.6987, 17.7886, 17.8476, 18.1515, 18.5683, 18.8688, 19.2862,
     19.6966, 20.0653, 20.4407, 20.8233, 21.2132, 21.6285, 22.052, 22.465, 22.9047, 23.3725, 23.85, 24.3169, 24.7515,
     25.2361, 25.7516, 26.2556, 26.725, 27.2026, 27.7348, 28.2538, 28.7586, 29.2727, 29.796, 30.3794, 30.948, 31.501,
     32.064, 32.6644, 33.2761, 33.9276, 34.5919, 35.2397, 35.8697, 36.5109, 37.1946, 37.9549, 38.6659, 39.3571, 40.094,
     40.8448, 41.6097, 42.4246, 43.2189, 44.0646, 44.9276, 45.6925, 46.4699, 47.3781, 48.3852, 49.3733, 50.2561,
     50.9365, 51.5861, 52.772, 53.8504, 54.9493, 56.1647, 57.3601, 58.6773, 59.8745, 60.9408, 62.3923, 63.6142, 65.0722,
     66.179, 67.638, 68.7899, 70.2472, 71.6801, 73.2652, 74.9472, 76.5392, 78.0993, 79.6905, 81.3828, 83.1813, 85.0208,
     86.9001, 88.9674, 90.8606, 91.7034, 93.807, 95.9584, 98.1606, 100, 200, 300, 400, 500, 600, 700, 800, 900, 1000],
    [0.470077, 0.480376, 0.490028, 0.495778, 0.500883, 0.508584, 0.516969, 0.520838, 0.513696, 0.525299, 0.527157,
     0.540059, 0.544513, 0.551562, 0.559918, 0.567625, 0.57598, 0.584984, 0.593984, 0.602985, 0.612636, 0.620989,
     0.62869, 0.636391, 0.645391, 0.655046, 0.664046, 0.671747, 0.6801, 0.690403, 0.700057, 0.707113, 0.714821,
     0.723828, 0.734131, 0.744434, 0.753434, 0.761789, 0.770796, 0.780451, 0.790103, 0.799755, 0.808755, 0.817755,
     0.827407, 0.83771, 0.848013, 0.857665, 0.86731, 0.87761, 0.887913, 0.896917, 0.906568, 0.91622, 0.925869, 0.934872,
     0.942576, 0.952225, 0.963179, 0.972189, 0.976653, 0.980462, 0.987514, 0.998466, 0.999063, 1.00874, 1.01448,
     1.02348, 1.02859, 1.03304, 1.04074, 1.04325, 1.04771, 1.04894, 1.05079, 1.06044, 1.05711, 1.06548, 1.06021,
     1.07181, 1.0659, 1.06971, 1.07351, 1.07537, 1.07724, 1.07911, 1.07968, 1.08089, 1.08275, 1.08656, 1.08907, 1.08704,
     1.09409, 1.09275, 1.09202, 1.09064, 1.0912, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1, 1.1]]
# массив точек графика f_2 рисунка 4.8
f_2_fric_mass = [
    [8.66E-04, 0.29223, 0.330315, 0.370733, 0.415117, 0.461542, 0.513159, 0.567866, 0.625452, 0.688878, 0.762318,
     0.843588, 0.931326, 1.03061, 1.14587, 1.28004, 1.42319, 1.57492, 1.75105, 1.95147, 2.16972, 2.40103, 2.657,
     2.96111, 3.30782, 3.68642, 4.10836, 4.5786, 5.09065, 5.67331, 6.32267, 7.04635, 7.87138, 8.79301, 9.79944, 10.9468,
     12.2285, 13.6603, 15.3318, 17.2485, 19.4047, 21.8305, 24.5595, 27.6296, 31.3779, 35.8874, 40.0893, 41.7274,
     45.6352, 51.8261, 64.0663, 72.7576, 89.9414, 97.9021
     ],
    [1, 1, 0.980931, 0.955006, 0.9238, 0.890159, 0.855538, 0.820144, 0.785195, 0.751735, 0.720635, 0.690822, 0.661387,
     0.634024, 0.61015, 0.589451, 0.568717, 0.546593, 0.525334, 0.506206, 0.487772, 0.468797, 0.449981, 0.433596,
     0.418887, 0.404674, 0.390441, 0.376709, 0.362991, 0.350224, 0.337906, 0.326021, 0.314961, 0.304668, 0.294331,
     0.284712, 0.275053, 0.266064, 0.258699, 0.252188, 0.24584, 0.239343, 0.232719, 0.227446, 0.224307, 0.222356,
     0.217315, 0.20353, 0.216534, 0.214096, 0.211722, 0.209338, 0.207016, 0.207052
     ]
]
# массив точек графика F_1 рисунка 4.7
F_1_mass = [
    [0.00452089, 0.00487242, 0.00525128, 0.00565959, 0.00609966, 0.00657394, 0.0070851, 0.00763601, 0.00880838,
     0.00940158, 0.0100626, 0.010815, 0.0116559, 0.0125622, 0.013539, 0.0145715, 0.0156828, 0.0169022, 0.0181912,
     0.0195785, 0.0211008, 0.02271, 0.0243405, 0.0259797, 0.0276142, 0.0293922, 0.0313282, 0.033438, 0.0357393,
     0.0380406, 0.0402102, 0.0423858, 0.0448033, 0.0474901, 0.0503381, 0.053283, 0.0563219, 0.0596996, 0.0634555,
     0.0673542, 0.0714925, 0.0762015, 0.0813332, 0.0871725, 0.0935606, 0.100417, 0.107776, 0.115674, 0.123978, 0.133064,
     0.142815, 0.153493, 0.165199, 0.178044, 0.191888, 0.20595, 0.220736, 0.236911, 0.254625, 0.272906, 0.292499,
     0.313499, 0.336006, 0.358635, 0.381727, 0.407434, 0.434872, 0.457767, 0.481867, 0.50025, 0.53246, 0.560492,
     0.591639, 0.621923, 0.652852, 0.683421, 0.717408, 0.752042, 0.834467, 0.875966, 0.922082, 0.969281, 1.02173,
     1.07701, 1.13371, 1.19339, 1.25971, 1.33341, 1.41337, 1.50021, 1.58577, 1.67854, 1.78662, 1.9043],
    [1.25982, 1.25821, 1.25841, 1.25861, 1.2579, 1.25719, 1.26011, 1.2685, 1.27896, 1.28098, 1.28209, 1.28228, 1.28064,
     1.279, 1.28105, 1.28679, 1.29535, 1.3021, 1.30324, 1.3025, 1.3074, 1.3161, 1.32675, 1.34134, 1.36096, 1.38585,
     1.41221, 1.43908, 1.46646, 1.49866, 1.53818, 1.58327, 1.62619, 1.66308, 1.7008, 1.74314, 1.78781, 1.83232, 1.87524,
     1.91917, 1.95989, 2.00005, 2.03517, 2.06646, 2.09673, 2.12133, 2.13697, 2.15272, 2.17171, 2.18143, 2.18333,
     2.18366, 2.184, 2.18749, 2.18783, 2.1756, 2.15876, 2.14052, 2.11786, 2.09242, 2.06579, 2.03803, 2.00487, 1.96656,
     1.9262, 1.88804, 1.8493, 1.8022, 1.77409, 1.75139, 1.70683, 1.67176, 1.62685, 1.58085, 1.53615, 1.49056, 1.44738,
     1.40543, 1.3271, 1.2905, 1.25493, 1.22032, 1.18668, 1.1548, 1.12215, 1.09122, 1.06267, 1.03636, 1.01144, 0.986403,
     0.963367, 0.942905, 0.919574, 0.900703]]
# массив точек графика F_2 рисунка 4.7
F_2_mass = [
    [0.00220124, 0.00234948, 0.00252516, 0.0027215, 0.00293312, 0.00316118, 0.00340698, 0.00366681, 0.00395192,
     0.0042592, 0.00458402, 0.00492677, 0.00529515, 0.00569897, 0.00613359, 0.00660135, 0.00710478, 0.00765722,
     0.00825261, 0.0088943, 0.00958588, 0.0103312, 0.0111346, 0.0120003, 0.0129155, 0.013862, 0.0148778, 0.0159459,
     0.0170908, 0.018267, 0.0194163, 0.0204668, 0.0214252, 0.0223043, 0.0231874, 0.0241388, 0.0251991, 0.0262331,
     0.0271962, 0.0280775, 0.0289875, 0.0299269, 0.0308967, 0.0319423, 0.0331609, 0.0345695, 0.0360379, 0.0375688,
     0.0390561, 0.0406024, 0.0423271, 0.0441863, 0.0460632, 0.0479534, 0.049921, 0.0519695, 0.0542522, 0.0566352,
     0.0592049, 0.0619771, 0.0648791, 0.0677289, 0.0708019, 0.074323, 0.0780191, 0.0818991, 0.085972, 0.0901224,
     0.094867, 0.100417, 0.106587, 0.11345, 0.121426, 0.130144, 0.139681, 0.150125, 0.16135, 0.173414, 0.186639,
     0.200873, 0.216492, 0.233002, 0.251119, 0.270645, 0.291285, 0.313499, 0.33694, 0.361631, 0.388132, 0.414845,
     0.459038, 0.494045, 0.552774, 0.617626, 0.660135, 0.70851, 0.760431, 0.812769, 0.867504, 0.928498, 0.991027,
     1.0563, 1.129, 1.20838, 1.28976, 1.37662, 1.47545, 1.58358, 1.69491, 1.80405
     ],
    [0.241939, 0.241939, 0.241628, 0.242363, 0.24275, 0.243138, 0.243702, 0.244091, 0.244306, 0.244872, 0.246147,
     0.247428, 0.248, 0.248039, 0.247899, 0.247759, 0.247619, 0.24748, 0.247519, 0.247558, 0.247419, 0.247102, 0.246608,
     0.24647, 0.247575, 0.249759, 0.252689, 0.25639, 0.260519, 0.265095, 0.27111, 0.278457, 0.287029, 0.296501,
     0.306505, 0.316848, 0.327542, 0.338595, 0.350269, 0.362604, 0.375373, 0.388033, 0.400831, 0.414053, 0.427407,
     0.441195, 0.455756, 0.470798, 0.487034, 0.503467, 0.520458, 0.53725, 0.554981, 0.573708, 0.592641, 0.612639,
     0.632405, 0.652809, 0.673388, 0.693619, 0.714972, 0.737509, 0.760758, 0.784183, 0.807166, 0.831421, 0.857022,
     0.882772, 0.906691, 0.92926, 0.951027, 0.971211, 0.988983, 1.00419, 1.0167, 1.02494, 1.02805, 1.02969, 1.03207,
     1.03372, 1.03239, 1.03033, 1.02975, 1.02695, 1.02121, 1.01332, 1.00404, 0.99412, 0.988561, 0.979493, 0.960851,
     0.946586, 0.928592, 0.904405, 0.890965, 0.882166, 0.874082, 0.861713, 0.848294, 0.8381, 0.826832, 0.813955,
     0.803014, 0.792223, 0.778765, 0.766087, 0.75525, 0.745642, 0.734035, 0.717936]]
# массив точек графика F_3 рисунка 4.7
F_3_mass = [
    [0.00210292, 0.00226644, 0.00244267, 0.00262894, 0.00282939, 0.00304937, 0.00328648, 0.00354203, 0.00381207,
     0.00409127, 0.004397, 0.00473214, 0.00507164, 0.00540531, 0.00573692, 0.00608038, 0.00643544, 0.00678292,
     0.00709971, 0.00741065, 0.00772444, 0.00807392, 0.00847445, 0.00885787, 0.00914371, 0.00962414, 0.0101017,
     0.0103699, 0.0109297, 0.0115199, 0.0120746, 0.012586, 0.0131373, 0.0137699, 0.014433, 0.0151701, 0.015967,
     0.0167824, 0.017615, 0.0184889, 0.0194601, 0.0205679, 0.021769, 0.0230083, 0.0243181, 0.0256669, 0.0270906,
     0.0286728, 0.0303895, 0.0322537, 0.0342798, 0.0364333, 0.0388299, 0.0414418, 0.0441682, 0.0470083, 0.0500309,
     0.0533218, 0.0569086, 0.060906, 0.0651844, 0.0697638, 0.0745611, 0.0796889, 0.0854057, 0.0914054, 0.0980988,
     0.10543, 0.11268, 0.118933, 0.128181, 0.136804, 0.147442, 0.157802, 0.168421, 0.180005, 0.192922, 0.207341,
     0.223457, 0.240157, 0.257392, 0.276246, 0.296482, 0.319089, 0.343894, 0.369595, 0.397218, 0.4281, 0.461386,
     0.495184, 0.530717, 0.569594, 0.613881, 0.661621, 0.71307, 0.767442, 0.824804, 0.887687, 0.956702, 1.03109,
     1.11127, 1.19767, 1.29076, 1.38916, 1.49301, 1.60686, 1.73181, 1.86649, 2.01163
     ],
    [0.821875, 0.821281, 0.821281, 0.823063, 0.825446, 0.827237, 0.826639, 0.826639, 0.830831, 0.839278, 0.84781,
     0.85643, 0.867014, 0.882818, 0.902815, 0.925268, 0.949651, 0.976086, 1.00543, 1.03791, 1.07299, 1.10765, 1.14178,
     1.17866, 1.22025, 1.2515, 1.28727, 1.33559, 1.37376, 1.412, 1.45446, 1.50035, 1.5477, 1.59539, 1.64336, 1.69154,
     1.73989, 1.79091, 1.84475, 1.90022, 1.95594, 2.00748, 2.0589, 2.11163, 2.16727, 2.22439, 2.27971, 2.33472, 2.39105,
     2.44875, 2.50603, 2.56279, 2.61706, 2.66668, 2.71725, 2.77479, 2.83559, 2.89773, 2.95268, 2.99999, 3.04585,
     3.08796, 3.1329, 3.17392, 3.21546, 3.26227, 3.30497, 3.33857, 3.38717, 3.44891, 3.44393, 3.50923, 3.50164, 3.53724,
     3.58613, 3.62521, 3.65414, 3.68063, 3.70732, 3.73961, 3.76672, 3.79404, 3.81879, 3.82984, 3.84648, 3.87998,
     3.91094, 3.91942, 3.92226, 3.94785, 3.9851, 4.0111, 4.014, 4.00242, 3.99664, 4.0082, 4.03435, 4.05481, 4.06361,
     4.06067, 4.05774, 4.06655, 4.09012, 4.11978, 4.13768, 4.14067, 4.13469, 4.12574, 4.11978
     ]]
# массив точек графика F_4 рисунка 4.7
F_4_mass = [
    [0.00203487, 0.00214615, 0.00225091, 0.00235748, 0.00246904, 0.00258236, 0.0026896, 0.00280518, 0.00293804,
     0.00308145, 0.00322282, 0.00337067, 0.00353032, 0.0037079, 0.00389441, 0.00409023, 0.00427788, 0.00446795,
     0.00467948, 0.00491478, 0.00516191, 0.00542146, 0.00569407, 0.00598877, 0.00632502, 0.00667092, 0.00701617,
     0.0073793, 0.0077721, 0.00818581, 0.00860962, 0.00905538, 0.00953739, 0.0100874, 0.0106988, 0.0113158, 0.0119179,
     0.0125345, 0.0132205, 0.0140027, 0.014852, 0.0157302, 0.0166137, 0.0175475, 0.0185854, 0.0196575, 0.020762,
     0.0218978, 0.0231281, 0.0244961, 0.0260909, 0.0277127, 0.0292298, 0.03083, 0.0327017, 0.034687, 0.0367909,
     0.0390231, 0.0416249, 0.0445264, 0.0475625, 0.0506626, 0.0540384, 0.0577231, 0.0618355, 0.0665211, 0.0715682,
     0.0767926, 0.0820498, 0.0876636, 0.0939278, 0.100779, 0.108272, 0.116488, 0.125514, 0.135057, 0.145529, 0.156812,
     0.168965, 0.181798, 0.195609, 0.210481, 0.22681, 0.244401, 0.263346, 0.28376, 0.305751, 0.329452, 0.355004,
     0.383059, 0.422057, 0.490045, 0.541351, 0.596334, 0.640798, 0.689567, 0.742061, 0.798566, 0.860532, 0.927256,
     0.997772, 1.07371, 1.15707, 1.24685, 1.34353, 1.44776, 1.56001, 1.68076,
     ],
    [-19.0007, -17.7997, -16.5038, -15.1763, -13.8172, -12.4897, -11.099, -9.70824, -8.41235, -7.11646, -5.75735,
     -4.39825, -3.10236, -1.86968, -0.637005, 0.627279, 1.98638, 3.34549, 4.67299, 5.93727, 7.20156, 8.46584, 9.73012,
     10.9628, 12.1639, 13.3649, 14.5976, 15.8303, 17.0314, 18.2324, 19.4335, 20.6346, 21.8356, 22.9419, 24.0165,
     25.1228, 26.3555, 27.6197, 28.7576, 29.8006, 30.8121, 31.9183, 33.0878, 34.194, 35.2687, 36.3433, 37.4812, 38.6506,
     39.7885, 40.8631, 41.8113, 42.7595, 43.8658, 44.972, 45.8886, 46.8053, 47.8167, 48.7965, 49.5867, 50.2504, 50.9774,
     51.7992, 52.6526, 53.3795, 53.9485, 54.391, 54.6754, 54.8018, 55.0863, 55.434, 55.6552, 55.8765, 56.2242, 56.477,
     56.5718, 56.6035, 56.6035, 56.6035, 56.6667, 56.8247, 56.9511, 56.9827, 56.9195, 56.8879, 56.9195, 56.9511,
     57.0143, 57.046, 57.0143, 57.0143, 56.7615, 56.7615, 56.7615, 56.8879, 56.8879, 56.7931, 56.6667, 56.5086, 56.4138,
     56.4138, 56.4138, 56.319, 56.161, 56.0661, 56.0661, 56.0029, 56.0029, 56.2242,
     ]]
# массив точек графика F_5 рисунка 4.9
F_5_mass = [
    [0.00183908, 0.00198045, 0.00212692, 0.00228416, 0.00245301, 0.00263803, 0.00284095, 0.00305948, 0.00328566,
     0.0035237, 0.00378953, 0.00408104, 0.00438879, 0.00471324, 0.00505465, 0.00543592, 0.00584601, 0.00626957,
     0.00673308, 0.00723081, 0.00774382, 0.00830488, 0.00893147, 0.00959189, 0.0102867, 0.0110012, 0.0117654, 0.0126179,
     0.0135509, 0.0145123, 0.0155204, 0.0166218, 0.0178512, 0.0191448, 0.0205036, 0.021928, 0.0233861, 0.0249412,
     0.0266369, 0.028448, 0.0304248, 0.0325392, 0.0346065, 0.0366517, 0.0387638, 0.0409403, 0.0434204, 0.0461796,
     0.0489089, 0.0515115, 0.0541769, 0.0574594, 0.0600109, 0.0628525, 0.0653707, 0.0681798, 0.0709114, 0.0732394,
     0.0749074, 0.0766129, 0.0787967, 0.0808169, 0.0819677, 0.0831347, 0.0847908, 0.0862383, 0.0873436, 0.08834,
     0.0899743, 0.0929278, 0.0938693, 0.0946564, 0.0954425, 0.0968127, 0.100411, 0.104872, 0.109074, 0.114079, 0.120317,
     0.127784, 0.136852, 0.146154, 0.154787, 0.164846, 0.177773, 0.191442, 0.203854, 0.218909, 0.234746, 0.250318,
     0.265802, 0.282243, 0.299281, 0.316017, 0.333222, 0.351856, 0.371012, 0.390116, 0.410779, 0.43375, 0.459291,
     0.484974, 0.509946, 0.536957, 0.568577, 0.604593, 0.640194, 0.674102, 0.710802, 0.752657, 0.798091, 0.8439,
     0.891092, 0.942244, 1.00053, 1.06689, 1.13607, 1.20973, 1.28817, 1.37361, 1.46472, 1.56408, 1.67256, 1.78857,
     1.90726, 2.03663
     ],
    [0.219965, 0.221994, 0.219293, 0.218177, 0.217223, 0.216272, 0.215786, 0.215302, 0.214054, 0.212055, 0.210374,
     0.209752, 0.209581, 0.208515, 0.207011, 0.205957, 0.204325, 0.202127, 0.200956, 0.200076, 0.198208, 0.196077,
     0.194245, 0.192568, 0.191042, 0.188988, 0.18669, 0.18455, 0.182957, 0.181119, 0.178788, 0.176488, 0.17434, 0.17185,
     0.169276, 0.166859, 0.16436, 0.161667, 0.159018, 0.156301, 0.153521, 0.150682, 0.147685, 0.144336, 0.140761,
     0.137276, 0.134162, 0.131213, 0.128055, 0.124527, 0.121011, 0.118014, 0.115011, 0.111525, 0.107914, 0.104569,
     0.101184, 0.097699, 0.0942683, 0.0910881, 0.0880146, 0.0849236, 0.0817671, 0.0787842, 0.0759638, 0.0732969,
     0.0706736, 0.068047, 0.0655642, 0.0633515, 0.0590677, 0.059618, 0.0613015, 0.0574425, 0.0555432, 0.053783,
     0.0520417, 0.0505005, 0.0491445, 0.0480642, 0.0474457, 0.0468687, 0.0461013, 0.0455084, 0.0455036, 0.0457596,
     0.0467467, 0.0473131, 0.0479206, 0.0488494, 0.0499747, 0.0511989, 0.0524532, 0.0538539, 0.0553316, 0.0568091,
     0.0583679, 0.0600554, 0.0617474, 0.0633963, 0.064996, 0.0667793, 0.06871, 0.0705954, 0.0723251, 0.0739909,
     0.075858, 0.0779953, 0.0801354, 0.0821574, 0.0842304, 0.0864794, 0.0887887, 0.0910293, 0.0931262, 0.0951347,
     0.0971868, 0.0992832, 0.101352, 0.103464, 0.105696, 0.10759, 0.108817, 0.109979, 0.111631, 0.113794
     ]]
# массив точек графика F_6 рисунка 4.9
F_6_mass = [
    [0.00208291, 0.00217175, 0.00223308, 0.00228975, 0.00235441, 0.00242765, 0.00250665, 0.00259905, 0.00270614,
     0.00280981, 0.00290529, 0.00299149, 0.00308025, 0.00318936, 0.0033254, 0.00347692, 0.00363028, 0.00377986,
     0.0039356, 0.00410348, 0.00428447, 0.00447968, 0.00469031, 0.00490401, 0.0051346, 0.00539101, 0.00567602,
     0.00597609, 0.00629203, 0.00664314, 0.00700409, 0.00738464, 0.00779673, 0.00824327, 0.00872754, 0.00925313,
     0.00982404, 0.0104884, 0.011229, 0.0120218, 0.0128706, 0.0137986, 0.0148347, 0.015993, 0.0171461, 0.0182547,
     0.0193271, 0.0203489, 0.0212761, 0.0221219, 0.0229374, 0.0237499, 0.0245227, 0.0251801, 0.0259273, 0.0267337,
     0.0275653, 0.0282649, 0.0288212, 0.0293068, 0.029967, 0.0307276, 0.0314636, 0.0321724, 0.0328971, 0.0335914,
     0.0342526, 0.0349269, 0.0357137, 0.0364674, 0.0371852, 0.0381821, 0.0388254, 0.0398107, 0.0405379, 0.0417988,
     0.042681, 0.0435817, 0.0444396, 0.0451255, 0.0462707, 0.0476436, 0.0486491, 0.0496067, 0.0509365, 0.052302,
     0.0534058, 0.0548375, 0.0564646, 0.0576563, 0.0585461, 0.0601994, 0.0617271, 0.0640918, 0.0649, 0.0665471,
     0.0689043, 0.0699678, 0.0709488, 0.0720438, 0.0734619, 0.0750123, 0.076064, 0.0772379, 0.0786487, 0.0797514,
     0.0812081, 0.082922, 0.0840846, 0.0852636, 0.0869419, 0.0887768, 0.0905242, 0.0921777, 0.0943856, 0.097186,
     0.100349, 0.104338, 0.109854, 0.116957, 0.125564, 0.134805, 0.144323, 0.153441, 0.162229, 0.171759, 0.182103,
     0.193339, 0.205268, 0.217024, 0.229135, 0.242934, 0.258282, 0.275365, 0.293579, 0.313433, 0.335097, 0.357759,
     0.381422, 0.408353, 0.438404, 0.470667, 0.505304, 0.541735, 0.582412, 0.627016, 0.675037, 0.725723, 0.782391,
     0.843484, 0.909348, 0.978991, 1.05544, 1.13943, 1.22841, 1.31881, 1.41586, 1.52642, 1.63875, 1.77411, 1.91264
     ],
    [0.853126, 0.825525, 0.794857, 0.76419, 0.735362, 0.707148, 0.67832, 0.650106, 0.622505, 0.594291, 0.56485,
     0.534183, 0.504128, 0.475301, 0.448313, 0.421326, 0.393112, 0.365511, 0.337297, 0.309696, 0.282708, 0.256947,
     0.231187, 0.204812, 0.179052, 0.153904, 0.129983, 0.105449, 0.0815287, 0.0582213, 0.0349139, 0.0116065,
     -0.00986082, -0.0294881, -0.0466619, -0.0638358, -0.0803963, -0.0957301, -0.109837, -0.120878, -0.127624,
     -0.131918, -0.135598, -0.134985, -0.126398, -0.109224, -0.0871432, -0.0626091, -0.0368483, -0.00863411, 0.0201934,
     0.049021, 0.0784619, 0.10913, 0.139184, 0.168625, 0.199292, 0.22996, 0.261241, 0.291295, 0.320736, 0.349564,
     0.377778, 0.405992, 0.43482, 0.463647, 0.491861, 0.520075, 0.548903, 0.579571, 0.611465, 0.642746, 0.683227,
     0.710828, 0.745176, 0.77523, 0.805898, 0.836565, 0.867846, 0.899127, 0.929181, 0.957396, 0.986223, 1.01566, 1.0451,
     1.07639, 1.10767, 1.13588, 1.1641, 1.19476, 1.22788, 1.25732, 1.29045, 1.34013, 1.37877, 1.42293, 1.46525, 1.49653,
     1.52659, 1.55725, 1.58792, 1.61798, 1.64742, 1.67686, 1885749, 1.73574, 1.76395, 1.79217, 1.82222, 1.85289,
     1.88294, 1.91361, 1.94489, 1.97495, 2.00439, 2.03444, 2.06511, 2.09516, 2.11847, 2.1289, 2.12583, 2.11479, 2.09946,
     2.08044, 2.05898, 2.0369, 2.01604, 1.99641, 1.97617, 1.95409, 1.93079, 1.90932, 1.8903, 1.87374, 1.85657, 1.84062,
     1.8259, 1.80996, 1.79585, 1.78419, 1.77499, 1.76702, 1.75782, 1.74862, 1.74433, 1.74126, 1.73697, 1.73145, 1.72715,
     1.72654, 1.72899, 1.73267, 1.73451, 1.73329, 1.73329, 1.73758, 1.74126, 1.74126, 1.74617, 1.75966, 1.75966
     ]]
# массив точек графика F_7 рисунка 4.9
F_7_mass = [
    [0.00218895, 0.0023378, 0.0025002, 0.00267384, 0.00285158, 0.00304119, 0.00325249, 0.00348332, 0.00372019,
     0.00397869, 0.00425509, 0.00454434, 0.00484654, 0.00516888, 0.00551266, 0.00589572, 0.00630537, 0.00673411,
     0.00718197, 0.00765965, 0.00816911, 0.00872466, 0.00930496, 0.00992386, 0.0105987, 0.0113352, 0.0120387, 0.0127679,
     0.0135601, 0.0144619, 0.0154238, 0.0164267, 0.0175192, 0.0186845, 0.0198995, 0.0211346, 0.0224776, 0.0239726,
     0.0255671, 0.0272298, 0.0288795, 0.0306291, 0.0326663, 0.0349848, 0.0363845, 0.0382656, 0.041387, 0.0437722,
     0.0468793, 0.0495807, 0.052511, 0.0558478, 0.0594792, 0.0633468, 0.067466, 0.0718533, 0.0764192, 0.0810487,
     0.086199, 0.0919318, 0.0981827, 0.104713, 0.111522, 0.118774, 0.126674, 0.1351, 0.144086, 0.153883, 0.164804,
     0.176502, 0.188241, 0.200482, 0.214114, 0.229309, 0.244899, 0.26155, 0.27933, 0.29832, 0.319044, 0.341683,
     0.365929, 0.391348, 0.419121, 0.448243, 0.481398, 0.51916, 0.556766, 0.599616, 0.643967, 0.691595, 0.7417,
     0.796546, 0.856629, 0.92253, 0.98936, 1.05807, 1.13469, 1.22196, 1.31594, 1.41718, 1.52411, 1.63451, 1.75533,
     1.88772, 2.03577, 2.19236, 2.36099, 2.53898, 2.72654, 2.94029
     ],
    [0.130368, 0.127866, 0.126221, 0.125132, 0.123699, 0.121759, 0.119935, 0.118139, 0.115954, 0.113973, 0.112426,
     0.1109, 0.109005, 0.106914, 0.104862, 0.10307, 0.101381, 0.0995775, 0.0977365, 0.095861, 0.0939544, 0.0920855,
     0.090254, 0.0884589, 0.0868232, 0.0852177, 0.0833444, 0.0814543, 0.0799488, 0.0785268, 0.0770199, 0.0754882,
     0.0739867, 0.072567, 0.0710223, 0.0693619, 0.0678371, 0.0664878, 0.0651654, 0.0637327, 0.0621984, 0.0607445,
     0.0595363, 0.0586024, 0.0574799, 0.056378, 0.0547449, 0.0533128, 0.0524017, 0.0511404, 0.0499094, 0.0488122,
     0.0478414, 0.0468899, 0.0459246, 0.044947, 0.0439589, 0.0429313, 0.0419875, 0.0412112, 0.0404781, 0.039673,
     0.0388563, 0.0380563, 0.0372994, 0.0365314, 0.0358048, 0.035193, 0.0346658, 0.034122, 0.0334672, 0.0327548,
     0.0321721, 0.0317128, 0.0312155, 0.030704, 0.0302657, 0.0298124, 0.0294077, 0.02905, 0.0286967, 0.0283476,
     0.0279628, 0.0275046, 0.0271312, 0.0269737, 0.0267791, 0.0264721, 0.0261126, 0.0257949, 0.0255358, 0.0252972,
     0.0251685, 0.0250583, 0.024842, 0.0246452, 0.024555, 0.02457, 0.024585, 0.0244424, 0.0241967, 0.0240221, 0.0239341,
     0.0238634, 0.0238098, 0.0237564, 0.023737, 0.0238195, 0.0239879, 0.0241056
     ]]


def look_graf(point: float, mass_graf: list) -> float:
    """
    Функция для поиска значения по графику.
    Находим интервал в который попадает значение point на графике mass_graf бинарным поиском.
    И выводим сред.арифм. значений точек интервала - это будет значение в точке point

    :param point: точка, которую ищем на графике
    :param mass_graf: график функции в виде [[массив Х][массив Y]]
    :return: значение в точке point по графику mass_graf
    """
    low = 0
    high = len(mass_graf[0]) - 1
    while high - low > 1:
        mid = int((high + low) / 2)
        if mass_graf[0][mid] > point:
            high = mid
        else:
            low = mid
    return (mass_graf[1][low] + mass_graf[1][high]) * 0.5


# используемые константы
# x_go = 178  # м^3ст.м^ - отношение добычи газа к нефти(не знаю на сколько важен параметр)
# q_o_N_U_input = 1590  # ст.м^3/сутки - дебит нефти
# q_g_N_U_input = 283  # тыс.м^ 3/сутки - дебит газа
# q_w_N_U_input = 0  # ст.м^3/сутки - дебит воды
B_o = 1.197  # м^3/ст.м^3 - объемный коэффициент нефти
B_g = 0.0091  # м^3/ст.м^3 - объемный коэффициент газа
B_w = 1  # м^3/ст.м^3 - объемный коэффициент воды
# R_s = 50.6  # ст.м^3/ст.м^3 - учитывает растворение газа в нефти(конденсацию) или выделение газа из нефти(выкипание)
R_sw = 1
d = 0.1524  # м - диаметр трубы
g = 9.81  # м/c^2 - const
sigma_o = 8.41 * pow(10, -3)  # кг/c^2 - поверхностное натяжение нефти
sigma_w = 80 * pow(10, -3)
# rho_L = 800 * (1-WC)/ B_o + 1000 * (1-WC)/ B_w  # 762.64  # кг/м^3 - плотность жидкости
rho_o_N_U = 800  # кг/м^3 - плотность нефти в н.у
rho_g_N_U = 700  # кг/м^3 - плотность газа в н.у
rho_w_N_U = 1000  # кг/м^3 - плотность воды в н.у
# rho_g = 700 / R_s #94.16  # кг/м^3 - плотность газа
# rho_w = 1000
mu_o = 0.97 * pow(10, -3)  # Па*c - вязкость нефти
mu_w = 1 * pow(10, -3)
varepsilon = 18.288 * pow(10, -6)  # м - абсолютная шероховатость трубы
#L = 2000  # м - длина скважины


def define_fp(q_l_N_U: float, R_s: float, WC: float = 0) -> list:
    """
    Функция, определяющая структуру потока.
    В зависимости от введенных значений дебитов определяем один из 4 режимов:
    1 = пузырьковый,
    2 = пробковый,
    3 = переходный,
    4 = эмульсионный.

    :param q_l_N_U: ст.м^3/сутки, дебит жидкости
    :param R_s: ст.м^3/ст.м^3, газовый фактор
    :param WC: %, обводненность
    :return: {1,2,3,4}, номер режима потока и еще 12 параметров, рассчитанных в данной функции
    """
    sigma_L = sigma_o * (1 - WC) + sigma_w * WC
    mu_L = mu_o * (1 - WC) + mu_w * WC
    rho_g = rho_g_N_U / R_s  # кг/м^3 - плотность газа
    rho_L = rho_o_N_U * (1 - WC) / B_o + rho_w_N_U * WC / B_w  # кг/м^3 - плотность жидкости
    q_o = q_l_N_U * (1 - WC) * B_o / 86400  # объемный дебит нефти
    q_w = q_l_N_U * WC * B_w / 86400  # объемный дебит воды
    q_L = q_o + q_w
    # q_g = (q_g_N_U - q_o_N_U * R_s - q_w_N_U * R_sw) * B_g / 86400  # объемный дебит газа
    q_g = q_l_N_U * (1 - WC) * R_s * B_g / 86400  # объемный дебит газа
    A_p = math.pi * pow(d, 2) / 4  # площадь поперечного сечения трубы
    v_SL = q_L / A_p  # приведенная скорость жидкости
    v_Sg = q_g / A_p  # приведенная скорость газа
    N_Lv = v_SL * pow(rho_L / (g * sigma_L), 0.25)  # показатель скорости жидкости
    N_gv = v_Sg * pow(rho_L / (g * sigma_L), 0.25)  # показатель скорости газа
    N_d = d * pow(g * rho_L / sigma_L, 0.5)  # показатель диаметра трубы
    N_L = mu_L * pow(g / (rho_L * pow(sigma_L, 3)), 0.25)  # показатель вязкости жидкости
    L_1 = look_graf(N_d, L_1_mass)
    L_2 = look_graf(N_d, L_2_mass)
    stage = 0  # режим потока
    if 0.1 < N_gv and N_gv <= L_1 + L_2 * N_Lv:
        stage = 1
    elif L_1 + L_2 * N_Lv < N_gv and N_gv <= 50 + 36 * N_Lv:
        stage = 2
    elif 50 + 36 * N_Lv < N_gv and N_gv <= 75 + 84 * pow(N_Lv, 0.75):
        stage = 3
    elif 75 + 84 * pow(N_Lv, 0.75) < N_gv and N_gv <= 0.001:
        stage = 4
    return [stage, q_L, q_g, rho_L, rho_g, sigma_L, mu_L, v_SL, v_Sg, N_Lv, N_gv, N_d, N_L]


def calc_grad_fric(q_l_N_U: float, R_s: float, WC: float = 0) -> float:
    """
    Функция, вычисляющая градиент давления на трение

    :param q_l_N_U: ст.м^3/сутки, дебит жидкости
    :param R_s: ст.м^3/ст.м^3, газовый фактор
    :param WC: %, обводненность
    :return: кг/м^3, значение градиента на трение
    """
    stage, q_L, q_g, rho_L, rho_g, sigma_L, mu_L, v_SL, v_Sg, N_Lv, N_gv, N_d, N_L = define_fp(q_l_N_U, R_s, WC)
    v_m = v_SL + v_Sg
    # считаем для Пробкового режима
    N_ReL = rho_L * v_Sg * d / mu_L  # число Рейнольдса для жидкости
    f_1 = 1 / pow(-2 * math.log10(
        2 / 3.7 * (varepsilon / d) - 5.02 / N_ReL * math.log10(2 / 3.7 * (varepsilon / d) + 13 / N_ReL)), 2)
    f_2_fric = look_graf((f_1 * v_Sg * pow(N_d, 2 / 3)) / (4 * v_SL), f_2_fric_mass)
    f_3 = 1 + f_1 / 4 * pow(v_Sg / (50 * v_SL), 0.5)
    f = f_1 * f_2_fric / f_3  # коэффициент трения
    dp_dz_Prob = (f * rho_L * v_SL * v_m) / (2 * d)
    if stage == 1 or stage == 2:  # Пузырьковый и Пробковый режим
        return dp_dz_Prob
    # выбираем плотность газа в зависимости от Переходного или Эмульсионного режима и
    # считаем dp_dz_Eml по формулам Эмульсионного режима
    if stage == 3:
        rho_g_Conv_Eml = rho_g * N_gv / (75 + 84 * pow(N_Lv, 0.75))
    elif stage == 4:
        rho_g_Conv_Eml = rho_g
    if stage == 3 or stage == 4:
        N_Reg = rho_g_Conv_Eml * v_Sg * d / mu_g  # число Рейнольдса для газовой фазы
        N_We = rho_g_Conv_Eml * pow(v_Sg, 2) * varepsilon / sigma_L  # число Вебера
        N_mu = pow(mu_L, 2) / (rho_L * sigma_L * varepsilon)
        if N_We * N_mu <= 0.005:
            e_d = (0.0749 * sigma_L) / (rho_g_Conv_Eml * pow(v_Sg, 2) * d)  # e_d это отношение varepsilon / d
        else:
            e_d = (0.3713 * sigma_L) / (rho_g_Conv_Eml * pow(v_Sg, 2) * d) * pow(N_We * N_mu, 0.302)
        if e_d <= 0.05:
            # коэффициент трения
            f_em = 1 / pow(-2 * math.log10(
                2 / 3.7 * (varepsilon / d) - 5.02 / N_Reg * math.log10(2 / 3.7 * (varepsilon / d) + 13 / N_Reg)), 2)
        else:
            f_em = 4 * (pow(4 * math.log10(0.27 * e_d), -2) + 0.067 * pow(e_d, 1.73))
        dp_dz_Eml = (f_em * rho_g_Conv_Eml * pow(v_Sg, 2)) / (2 * d)

    if stage == 3:  # Переходный режим
        A = (75 + 84 * pow(N_Lv, 0.75) - N_gv) / (
                (75 + 84 * pow(N_Lv, 0.75)) - (50 + 36 * N_Lv))  # коэффициент для эмульсионного режима
        return A * dp_dz_Prob + (1 - A) * dp_dz_Eml
    elif stage == 4:  # Эмульсионный режим
        return dp_dz_Eml
    elif stage == 0:  # ни один из режимов
        return 0


def calc_grad_grav(q_l_N_U: float, R_s: float, WC: float = 0) -> float:
    """
    Функция, вычисляющая градиент давления на гравитацию

    :param q_l_N_U: ст.м^3/сутки, дебит жидкости
    :param R_s: ст.м^3/ст.м^3, газовый фактор
    :param WC: %, обводненность
    :return: кг/м^3, значение градиента на гравитацию
    """
    stage, q_L, q_g, rho_L, rho_g, sigma_L, mu_L, v_SL, v_Sg, N_Lv, N_gv, N_d, N_L = define_fp(q_l_N_U, R_s, WC)
    v_m = v_SL + v_Sg
    # считаем для Пробкового режима
    if stage == 1 or stage == 2 or stage == 3:
        F_1 = look_graf(N_L, F_1_mass)
        F_2 = look_graf(N_L, F_2_mass)
        F_3 = look_graf(N_L, F_3_mass)
        F_4 = look_graf(N_L, F_4_mass)
        F_3_shift = F_3 - F_4 / N_d
        F_5 = look_graf(N_L, F_5_mass)
        F_6 = look_graf(N_L, F_6_mass)
        F_7 = look_graf(N_L, F_7_mass)
        F_6_shift = 0.029 * N_d + F_6
        if stage == 1 or stage == 3:
            S = F_1 + F_2 * N_Lv + F_3_shift * pow(N_gv / (1 + N_Lv),
                                                   2)  # безразмерный показатель скорости проскальзывания
        elif stage == 2:
            S = (1 + F_5) * (pow(N_gv, 0.982) + F_6_shift) / (1 + F_7 * N_Lv)
        v_s = S / pow(rho_L / (g * sigma_L), 0.25)  # скорость проскальзывания
        H_L = (v_s - v_m + pow((v_m - v_s) ** 2 + 4 * v_s * v_SL, 0.5)) / (2 * v_s)  # объемное содержание жидкости
        rho_s = rho_L * H_L + rho_g * (1 - H_L)  # плотность жидкости с учетом проскальзывания
        dp_dz_Prob = rho_s * g
    if stage == 1 or stage == 2:  # Пузырьковый и Пробковый режим
        return S  # dp_dz_Prob
    # выбираем плотность газа в зависимости от Переходного или Эмульсионного режима и
    # считаем dp_dz_Eml по формулам Эмульсионного режима
    if stage == 3:
        rho_g_Conv_Eml = rho_g * N_gv / (75 + 84 * pow(N_Lv, 0.75))
    elif stage == 4:
        rho_g_Conv_Eml = rho_g
    if stage == 3 or stage == 4:
        H_L = q_L / (q_L + q_g)  # объемное содержание жидкости
        rho_s = rho_L * H_L + rho_g_Conv_Eml * (1 - H_L)  # плотность жидкости с учетом проскальзывания
        dp_dz_Eml = rho_s * g
    if stage == 3:  # Переходный режим
        A = (75 + 84 * pow(N_Lv, 0.75) - N_gv) / (
                (75 + 84 * pow(N_Lv, 0.75)) - (50 + 36 * N_Lv))  # коэффициент для эмульсионного режима
        return A * dp_dz_Prob + (1 - A) * dp_dz_Eml
    elif stage == 4:  # Эмульсионный режим
        return dp_dz_Eml
    elif stage == 0:  # ни один из режимов
        return 0


def calc_grad(q_l_N_U: float, R_s: float, WC: float = 0) -> float:
    """
    Функция, вычисляющая градиент давления на гравитацию

    :param q_l_N_U: ст.м^3/сутки, дебит жидкости
    :param R_s: ст.м^3/ст.м^3, газовый фактор
    :param WC: %, обводненность
    :return: бар/м, общий градиент давления = на трение + на гравитацию
    """
    return 978 * pow(10, -7) * (calc_grad_fric(q_l_N_U, R_s, WC) + calc_grad_grav(q_l_N_U, R_s, WC))


def calc_pressure(q_l_N_U: float, R_s: float, WC: float = 0, L: float = 2000) -> float:
    """
    Функция, определяющая давление в трубе путем интегрирования градиента

    :param q_l_N_U: ст.м^3/сутки, дебит жидкости
    :param R_s: ст.м^3/ст.м^3, газовый фактор
    :param WC: %, обводненность
    :param L: м, длина
    :return: бар, давление на глубине L
    """
    return round(L * calc_grad(q_l_N_U, R_s, WC), 3)



